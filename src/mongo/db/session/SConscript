# -*- mode: python -*-
Import("env")

env = env.Clone()

env.Library(
    target="sessions_collection_mock",
    source=[
        "sessions_collection_mock.cpp",
    ],
    LIBDEPS=[
        "$BUILD_DIR/mongo/base",
        "logical_session_id",
        "sessions_collection",
    ],
)

env.Library(
    target="service_liaison_mongod",
    source=[
        "service_liaison_shard.cpp",
        "sessions_collection_standalone.cpp",
    ],
    LIBDEPS=[
        "$BUILD_DIR/mongo/base",
        "$BUILD_DIR/mongo/db/dbdirectclient",
        "logical_session_cache_impl",
        "logical_session_id",
        "sessions_collection",
    ],
    LIBDEPS_PRIVATE=[
        "$BUILD_DIR/mongo/db/query/client_cursor/client_cursor",
        "$BUILD_DIR/mongo/db/query_exec",
        "$BUILD_DIR/mongo/db/service_context",
        "$BUILD_DIR/mongo/s/grid",
        "$BUILD_DIR/mongo/s/query/exec/cluster_cursor_manager",
        "$BUILD_DIR/mongo/util/clock_sources",
        "$BUILD_DIR/mongo/util/periodic_runner",
    ],
)

env.Library(
    target="kill_sessions_local",
    source=[
        "kill_sessions_local.cpp",
    ],
    LIBDEPS=[
        "$BUILD_DIR/mongo/db/query_exec",
    ],
    LIBDEPS_PRIVATE=[
        "$BUILD_DIR/mongo/db/query/client_cursor/client_cursor",
        "$BUILD_DIR/mongo/db/transaction/transaction",
        "kill_sessions",
        "session_catalog",
    ],
)

env.Library(
    target="kill_sessions_remote",
    source=[
        "kill_sessions_remote.cpp",
    ],
    LIBDEPS=[
        "$BUILD_DIR/mongo/db/query_exec",
    ],
    LIBDEPS_PRIVATE=[
        "$BUILD_DIR/mongo/executor/async_multicaster",
        "kill_sessions",
    ],
)

env.Library(
    target="session_catalog_mongod",
    source=[
        "internal_transactions_reap_service.cpp",
        "internal_transactions_reap_service_gen.cpp",
        "session_catalog_mongod.cpp",
        "session_txn_record_gen.cpp",
    ],
    LIBDEPS=[
        "session_catalog",
    ],
    LIBDEPS_PRIVATE=[
        "$BUILD_DIR/mongo/db/catalog/collection_options",
        "$BUILD_DIR/mongo/db/coll_mod_command_idl",
        "$BUILD_DIR/mongo/db/commands/mongod_fcv",
        "$BUILD_DIR/mongo/db/dbdirectclient",
        "$BUILD_DIR/mongo/db/index_builds_coordinator_interface",
        "$BUILD_DIR/mongo/db/index_commands_idl",
        "$BUILD_DIR/mongo/db/internal_transactions_feature_flag",
        "$BUILD_DIR/mongo/db/repl/repl_coordinator_interface",
        "$BUILD_DIR/mongo/db/repl/repl_server_parameters",
        "$BUILD_DIR/mongo/db/repl/replica_set_aware_service",
        "$BUILD_DIR/mongo/db/repl/storage_interface",
        "$BUILD_DIR/mongo/db/server_base",
        "$BUILD_DIR/mongo/db/service_context",
        "$BUILD_DIR/mongo/db/shard_role",
        "$BUILD_DIR/mongo/util/concurrency/thread_pool",
        "kill_sessions",
        "logical_session_id",
        "logical_session_id_helpers",
    ],
)
