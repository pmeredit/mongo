# Copyright (C) 2019-present MongoDB, Inc.

global:
    cpp_namespace: "mongo::audit"
    cpp_includes:
        - "audit/audit_options.h"
    configs:
        section: 'Auditing Options'
        source: [ cli, ini, yaml ]

server_parameters:
    auditAuthorizationSuccess:
        description: 'Enable to audit when authentication succeeds'
        set_at: [ startup, runtime ]
        default: false
        cpp_class:
            name: AuditAuthorizationSuccessSetParameter
            override_set: true

configs:
    "auditLog.destination":
        description: 'Destination of audit log output. (console/syslog/file)'
        short_name: auditDestination
        arg_vartype: String
        validator:
            callback: validateAuditLogDestination
    "auditLog.format":
        description: 'Format of the audit log, if logging to a file. (BSON/JSON)'
        short_name: auditFormat
        arg_vartype: String
        requires: 'auditLog.destination'
        validator:
            callback: validateAuditLogFormat
    "auditLog.path":
        description: 'Full filespec for audit log file'
        short_name: auditPath
        arg_vartype: String
        requires: 'auditLog.destination'
    "auditLog.runtimeConfiguration":
        description: "Configure audit filter and auditAuthorizationSuccess via commands"
        short_name: auditRuntimeConfiguration
        arg_vartype: Bool
        requires: 'auditLog.destination'
    "auditLog.filter":
        description: 'Filter spec to screen audit records'
        short_name: auditFilter
        arg_vartype: String
        requires: 'auditLog.destination'
    "auditLog.compressionMode":
        description: 'Mode to be used for compressing the audit log'
        short_name: auditCompressionMode
        arg_vartype: String
        requires: 'auditLog.destination'
    "auditLog.localAuditKeyFile":
        description: 'File path of the audit log encryption key file'
        short_name: auditLocalKeyFile
        arg_vartype: String
        requires: 'auditLog.destination'
