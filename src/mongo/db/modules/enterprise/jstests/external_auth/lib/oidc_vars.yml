tokens:
  # Basic authentication as a user with read privileges.
  - name: 'Token_OIDCAuth_user1'
    key: 'src/mongo/db/modules/enterprise/jstests/external_auth/lib/custom-key-1.priv'
    alg: 'RS256'
    kid: 'custom-key-1'
    body:
        iss: 'https://test.kernel.mongodb.com/oidc/issuer1'
        sub: 'user1@mongodb.com'
        iat: 1661374077
        exp: 2147483647
        aud: [ 'jwt@kernel.mongodb.com' ]
        nonce: 'gdfhjj324ehj23k4'
        auth_time: 1661374077
        "mongodb-roles":
            - myReadRole

  # Basic authentication as a user with readWrite privileges.
  - name: 'Token_OIDCAuth_user2'
    key: 'src/mongo/db/modules/enterprise/jstests/external_auth/lib/custom-key-1.priv'
    alg: 'RS256'
    kid: 'custom-key-1'
    body:
        iss: 'https://test.kernel.mongodb.com/oidc/issuer1'
        sub: 'user2@mongodb.com'
        iat: 1661374077
        exp: 2147483647
        aud: [ 'jwt@kernel.mongodb.com' ]
        nonce: 'gdfhjj324ehj23k4'
        auth_time: 1661374077
        "mongodb-roles":
            - myReadWriteRole

  # Basic authentication as a user with read privileges.
  - name: 'Token_OIDCAuth_user1@10gen'
    key: 'src/mongo/db/modules/enterprise/jstests/external_auth/lib/custom-key-2.priv'
    alg: 'RS256'
    kid: 'custom-key-2'
    body:
        iss: 'https://test.kernel.mongodb.com/oidc/issuer2'
        sub: 'user1@10gen.com'
        iat: 1661374077
        exp: 2147483647
        aud: [ 'jwt@kernel.mongodb.com' ]
        nonce: 'gdfhjj324ehj23k4'
        auth_time: 1661374077
        "mongodb-roles":
            - myReadRole

  # Identical to 'Token_OIDCAuth_user1', except that the `exp` time has elapsed.
  - name: 'Token_OIDCAuth_user1_expired'
    key: 'src/mongo/db/modules/enterprise/jstests/external_auth/lib/custom-key-1.priv'
    alg: 'RS256'
    kid: 'custom-key-1'
    body:
        iss: 'https://test.kernel.mongodb.com/oidc/issuer1'
        sub: 'user1@mongodb.com'
        iat: 1661374077
        exp: 1671637210
        aud: [ 'jwt@kernel.mongodb.com' ]
        nonce: 'gdfhjj324ehj23k4'
        auth_time: 1661374077
        "mongodb-roles":
            - myReadRole

  # Identical to 'Token_OIDCAuth_user1', except that the `iat` time has yet to come.
  - name: 'Token_OIDCAuth_user1_not_yet_valid'
    key: 'src/mongo/db/modules/enterprise/jstests/external_auth/lib/custom-key-1.priv'
    alg: 'RS256'
    kid: 'custom-key-1'
    body:
        iss: 'https://test.kernel.mongodb.com/oidc/issuer1'
        sub: 'user1@mongodb.com'
        iat: 2147000000
        exp: 2147483647
        aud: [ 'jwt@kernel.mongodb.com' ]
        nonce: 'gdfhjj324ehj23k4'
        auth_time: 1661374077
        "mongodb-roles":
            - myReadRole

  # Identical to 'Token_OIDCAuth_user1', except that it was not issued to us.
  - name: 'Token_OIDCAuth_user1_wrong_audience'
    key: 'src/mongo/db/modules/enterprise/jstests/external_auth/lib/custom-key-1.priv'
    alg: 'RS256'
    kid: 'custom-key-1'
    body:
        iss: 'https://test.kernel.mongodb.com/oidc/issuer1'
        sub: 'user1@mongodb.com'
        iat: 1661374077
        exp: 2147483647
        aud: [ 'jwt@kernel.10gen.com' ]
        nonce: 'gdfhjj324ehj23k4'
        auth_time: 1661374077
        "mongodb-roles":
            - myReadRole

  # Identical to 'Token_OIDCAuth_user1', except that was issued by another party/
  - name: 'Token_OIDCAuth_user1_wrong_issuer'
    key: 'src/mongo/db/modules/enterprise/jstests/external_auth/lib/custom-key-1.priv'
    alg: 'RS256'
    kid: 'custom-key-1'
    body:
        iss: 'https://test.kernel.10gen.com/oidc/issuerX'
        sub: 'user1@mongodb.com'
        iat: 1661374077
        exp: 2147483647
        aud: [ 'jwt@kernel.mongodb.com' ]
        nonce: 'gdfhjj324ehj23k4'
        auth_time: 1661374077
        "mongodb-roles":
            - myReadRole

payloads:
  - name: 'emptyObject'
    data: {}

  - name: 'Advertize_OIDCAuth_user1'
    data:
        n: 'user1@mongodb.com'
  - name: 'Advertize_OIDCAuth_user2'
    data:
        n: 'user2@mongodb.com'
  - name: 'Advertize_OIDCAuth_user1@10gen'
    data:
        n: 'user1@10gen.com'

  - name: 'Authenticate_OIDCAuth_user1'
    data:
        jwt: 'token:Token_OIDCAuth_user1'
  - name: 'Authenticate_OIDCAuth_user2'
    data:
        jwt: 'token:Token_OIDCAuth_user2'
  - name: 'Authenticate_OIDCAuth_user1@10gen'
    data:
        jwt: 'token:Token_OIDCAuth_user1@10gen'

  - name: 'Authenticate_OIDCAuth_user1_expired'
    data:
        jwt: 'token:Token_OIDCAuth_user1_expired'
  - name: 'Authenticate_OIDCAuth_user1_not_yet_valid'
    data:
        jwt: 'token:Token_OIDCAuth_user1_not_yet_valid'
  - name: 'Authenticate_OIDCAuth_user1_wrong_audience'
    data:
        jwt: 'token:Token_OIDCAuth_user1_wrong_audience'
  - name: 'Authenticate_OIDCAuth_user1_wrong_issuer'
    data:
        jwt: 'token:Token_OIDCAuth_user1_wrong_issuer'

